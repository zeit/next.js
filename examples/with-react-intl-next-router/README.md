# Example app with [React Intl] and [Next.js Internationalized Routing](https://nextjs.org/docs/advanced-features/i18n-routing)

This example app shows how to integrate [React Intl][] with Next.js and with [internationalized routing](https://nextjs.org/docs/advanced-features/i18n-routing).

## How to use

Execute [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app) with [npm](https://docs.npmjs.com/cli/init) or [Yarn](https://yarnpkg.com/lang/en/docs/cli/create/) to bootstrap the example:

```bash
npx create-next-app --example with-react-intl with-react-intl-next-router-app
# or
yarn create next-app --example with-react-intl with-react-intl-next-router-app
```

Deploy it to the cloud with [Vercel](https://vercel.com/new?utm_source=github&utm_medium=readme&utm_campaign=next-example) ([Documentation](https://nextjs.org/docs/deployment)).

## Features of this example app

- Automatic language negotiation using Next.js internationalized routing
- React Intl integration with [custom App](https://github.com/vercel/next.js#custom-app) component
- `<IntlProvider>` creation with `locale`, `messages` props
- Default message extraction via `@formatjs/cli` integration
- Pre-compile messages into AST and suppression of `defaultMessage` with `babel-plugin-formatjs` for performance and reduced bundle size
- Usage of "no-parser" version of `react-intl` for performance and reduced bundle size
- Translation management via build script

### Translation Management

This app stores translations and default strings in the `intl/extracted-lang/` directory. The default messages (`en.json` in this example app) is also generated by the build script. This file can then be sent to a translation service to perform localization for the other locales the app should support.

```bash
$ yarn build
$ yarn start
```

You can then switch your language preferences using a `<select>` or a link.

User prefered language is persist across navigation using the [`NEXT_LOCALE cookie`](https://nextjs.org/docs/advanced-features/i18n-routing#leveraging-the-next_locale-cookie).

[react intl]: https://formatjs.io

### Supported locales

A `.env` file is available with two keys useful to define supported locales:

- `SUPPORTED_LOCALES` is a comma-separated list of supported values by the application
- `DEFAULT_LOCALE` is the locale that will be used as fallback for translation messages and for Next.js internationalized routing. The value must be included in `SUPPORTED_LOCALES`.

### Node.js polyfill

Since version 13, Node.js includes [`full-icu` package](https://github.com/nodejs/node/blob/master/doc/changelogs/CHANGELOG_V13.md#notable-changes-16), which means all locales are know included by default.

However, if your Node.js version is lower than version 13, you must install [`full-icu`](https://www.npmjs.com/package/full-icu) from `npm` and update some `scripts` of the `package.json`.

Change the `dev` and `start` scripts by pre-fixing them with `NODE_ICU_DATA=node_modules/full-icu`.

```json
"scripts": {
  "dev": "NODE_ICU_DATA=node_modules/full-icu next dev",
  "start": "NODE_ICU_DATA=node_modules/full-icu next start"
}
```
